
<!-- saved from url=(0064)http://moss.stanford.edu/results/7/7834820277962/match6-1.html#6 -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>/winter25/srhsenth/pa6/BigInteger.cpp</title>
<script id="simplify-jobs-page-script" src="chrome-extension://pbanhockgagggenencehbnadejlgchfc/js/pageScript.bundle.js"></script></head>
<body bgcolor="white">
<hr>
/winter25/mchave83/pa6/BigInteger.cpp<p></p><pre>#include "BigInteger.h"
#include "List.h"
#include &lt;cctype&gt;
#include &lt;cmath&gt;
#include &lt;stdexcept&gt;

<a name="4"></a><font color="#FF00FF"><a href="http://moss.stanford.edu/results/7/7834820277962/match6-0.html#4" target="0"><img src="./tm_4_3.gif" alt="other" border="0" align="left"></a>

using namespace std;

const ListElement BASE  = 1000000000;  
const int  POWER = 9;           

void zero(List* L) {
    L-&gt;moveFront();
    while (L-&gt;length() &gt; 0 &amp;&amp; !L-&gt;peekNext()) {
        L-&gt;eraseAfter();
    }
}

List multi(long multiplier, List *b, int* ctr) {
    List result;
    long carry = 0;
    long temp = 0;
</font>    for (b-&gt;moveBack(); b-&gt;position() &gt; 0; b-&gt;movePrev()) {
        temp = (b-&gt;peekPrev() * multiplier) + carry;
        carry = temp / BASE;
        temp %= BASE;
        result.insertAfter(temp);
    }
    if (carry &gt; 0) {
<a name="5"></a><font color="#FF0000"><a href="http://moss.stanford.edu/results/7/7834820277962/match6-0.html#5" target="0"><img src="./tm_0_3.gif" alt="other" border="0" align="left"></a>

        result.insertAfter(carry);
    }
    result.moveBack();
    for (int i = 0; i &lt; *ctr; i++) {
        result.insertAfter(0);
    }
    return result;
}

BigInteger::BigInteger() {
    signum = 0;
    digits = List();
}

BigInteger::BigInteger(long x) {
    if (x == 0) {
        signum = 0;
        digits.insertAfter(0);
        return;
    }
    if (x &lt; 0) {
</font>        signum = -1;
        x = -x;
    } else {
<a name="0"></a><font color="#FF0000"><a href="http://moss.stanford.edu/results/7/7834820277962/match6-0.html#0" target="0"><img src="./tm_0_24.gif" alt="other" border="0" align="left"></a>

        signum = 1;
    }
    while (x &gt; 0) {
        digits.insertBefore(x % BASE);
        x /= BASE;
    }
}

BigInteger::BigInteger(std::string s) {
    if (!s.length()) {
        throw std::invalid_argument("Bint constcutr empty string");
    }
    int offset = 0;
    if ((s[0] == '+') | (s[0] == '-')) {
        signum = 1;
        if (s[0] == '-') {
            signum = -1;
        }
        offset = 1;
        s = s.substr(offset, s.length() - 1);
    } else {
        signum = 1;
    }
    for (long unsigned int i = 0; i &lt; s.length();) {
        if (!std::isdigit(s[i])) {
            throw std::invalid_argument("BigInt Constructor returnginn  non-numeric");
        }
        i = i + 1;
    }
    std::string num = "";
    List tempList;
    size_t max = 0;
    size_t curr_digits = s.length();
    while (max &lt; s.length() / POWER) {
        num = s.substr(curr_digits - POWER, POWER);
        digits.insertAfter(std::stol(num, nullptr, 10));
        curr_digits = curr_digits - POWER;
        max++;
    }
    if (curr_digits &gt; 0) {
        num = s.substr(0, curr_digits);
        digits.insertAfter(std::stol(num, nullptr, 10));
    }

    zero(&amp;digits);  
}

BigInteger::BigInteger(const BigInteger&amp; other) {
    this-&gt;signum = other.signum;
    this-&gt;digits = other.digits;
}

int BigInteger::sign() const {
    return this-&gt;signum;
}

int BigInteger::compare(const BigInteger&amp; other) const {
    if (signum &gt; other.signum) {
        return 1;
    }
    else if (signum &lt; other.signum) {
        return -1;
    }
    else if (signum == 0 &amp;&amp; other.signum == 0) {
        return 0;
    }
    const List&amp; A = digits;
    const List&amp; B = other.digits;
    int length = A.length();
    if (length != B.length()) {
        return (length &gt; B.length()) ? signum : -other.signum;
    }
    List A_copy = A;
    List B_copy = B;
    A_copy.moveFront();
    B_copy.moveFront();
    for (int i = 0; i &lt; length; ++i) {
        if (A_copy.peekNext() &gt; B_copy.peekNext()) {
            return signum;
        }
        else if (A_copy.peekNext() &lt; B_copy.peekNext()) {
            return -other.signum;
        }
        A_copy.moveNext();
        B_copy.moveNext();
    }
    return 0;
}

void BigInteger::makeZero() {
    digits.clear();
    signum = 0;
}

void BigInteger::negate() {
    signum *= -1;
}

BigInteger BigInteger::add(const BigInteger&amp; other) const {
    BigInteger X = *this;
    BigInteger Y = other;
    BigInteger result;
</font>
    if (X.sign() &gt; 0 &amp;&amp; Y.sign() &lt; 0) {
        Y.negate();
        return X.sub(Y);
    } else if (X.sign() &lt; 0 &amp;&amp; Y.sign() &gt; 0) {
        X.negate();
        return Y.sub(X);
    } else if (X.sign() &lt; 0 &amp;&amp; Y.sign() &lt; 0) {
        X.negate();
        Y.negate();
        result = X.add(Y);
        result.negate();
        return result;
    }

    if (X &gt; Y) {
<a name="2"></a><font color="#0000FF"><a href="http://moss.stanford.edu/results/7/7834820277962/match6-0.html#2" target="0"><img src="./tm_2_7.gif" alt="other" border="0" align="left"></a>

        return Y.add(X);
    }

    List x = X.digits;
    List y = Y.digits;
    List z = result.digits;

    long carry = 0;
    long temp = 0;

    x.moveBack();
    y.moveBack();
    while (x.position() &gt; 0 &amp;&amp; y.position() &gt; 0) {
        temp = carry + x.peekPrev() + y.peekPrev();
        carry = temp / BASE;
        temp %= BASE;
        z.insertAfter(temp);
        x.movePrev();
        y.movePrev();
    }

    while (y.position() &gt; 0) {
        temp = carry + y.peekPrev();
        carry = temp / BASE;
        temp %= BASE;
        z.insertAfter(temp);
        y.movePrev();
    }

    if (carry &gt; 0) {
        z.insertAfter(carry);
    }

    result.signum = 1;
    result.digits = z;
    return result;
}

BigInteger BigInteger::sub(const BigInteger&amp; other) const {
</font>    BigInteger B = *this;
    BigInteger A = other;
    BigInteger result;
<a name="6"></a><font color="#00FF00"><a href="http://moss.stanford.edu/results/7/7834820277962/match6-0.html#6" target="0"><img src="./tm_1_2.gif" alt="other" border="0" align="left"></a>

    List a = A.digits;
    List b = B.digits;
    List c = result.digits;

    if (A == B) {
        return result;
    }
    if (A.sign() &amp;&amp; !B.sign()) {
        A.negate();
        return A;
    }
    if (!A.sign() &amp;&amp; B.sign()) {
</font>        return B;
    }
    if (A.sign() &lt; 0 &amp;&amp; B.sign() &gt; 0) {
        B.negate();
        result = A.add(B);
        result.negate();
        return result;
    }
    if (A.sign() &gt; 0 &amp;&amp; B.sign() &lt; 0) {
        A.negate();
        result = A.add(B);
        return result;
    }
    if (A.sign() &lt; 0 &amp;&amp; B.sign() &lt; 0) {
        A.negate();
        B.negate();
        result = B.sub(A);
        result.negate();
        return result;
    }
    if (A &lt; B) {
        result = A.sub(B);
<a name="1"></a><font color="#00FF00"><a href="http://moss.stanford.edu/results/7/7834820277962/match6-0.html#1" target="0"><img src="./tm_1_10.gif" alt="other" border="0" align="left"></a>

        result.negate();
        return result;
    }

    a.moveBack();
    b.moveBack();
    long dist = 0;
    long temp = 0;
    int i = b.position();
    while (!(i &lt;= 0)) {
        if (a.peekPrev() - dist &lt; b.peekPrev()) {
            temp = a.peekPrev() + BASE - b.peekPrev() - dist;
            dist = 1;
        } else {
            temp = a.peekPrev() - dist - b.peekPrev();
            if (!(a.peekPrev() &lt;= 0)) {
                dist = 0;
            }
        }
        c.insertAfter(temp);
        a.movePrev();
        b.movePrev();
        i--;
    }
    while (a.position() &gt; 0) {
        if (a.peekPrev() - dist &lt; 0) {
            temp = a.peekPrev() + BASE - 0 - dist;
            dist = 1;
        } else {
            temp = a.peekPrev() - dist - 0;
            if (!(a.peekPrev() &lt;= 0)) {
                dist = 0;
            }
        }
        c.insertAfter(temp);
        a.movePrev();
    }
    result.digits = c;
    zero(&amp;(result.digits));  
    result.signum = -1;  
    return result;
}

BigInteger BigInteger::mult(const BigInteger&amp; other) const {
</font>    BigInteger B = *this;
    BigInteger A = other;
    BigInteger result;
    List a = A.digits;
    List b = B.digits;
<a name="3"></a><font color="#00FFFF"><a href="http://moss.stanford.edu/results/7/7834820277962/match6-0.html#3" target="0"><img src="./tm_3_6.gif" alt="other" border="0" align="left"></a>

    int ctr = 0;
    a.moveBack();
    b.moveBack();
    int p = a.position();
    for (int i = p; i &gt; 0; i--) {
        List temp = multi(a.peekPrev(), &amp;b, &amp;ctr);
        BigInteger tempResult;
        tempResult.signum = 1;
        tempResult.digits = temp;
        result = result.add(tempResult);
        a.movePrev();  
        ctr++;
    }
    result.signum = A.signum * B.signum;  
    return result;
}

std::string BigInteger::to_string() {
    std::string out = "";
    if (this-&gt;signum == 0) {
        return "0";
    } else if (signum == -1) {
        out += "-";
    }
    digits.moveFront();
</font>    while (digits.front() == 0 &amp;&amp; digits.length() &gt; 1) {
        digits.eraseAfter();
    }
<a name="8"></a><font color="#00FFFF"><a href="http://moss.stanford.edu/results/7/7834820277962/match6-0.html#8" target="0"><img src="./tm_3_1.gif" alt="other" border="0" align="left"></a>

    for (digits.moveFront(); digits.position() &lt; digits.length(); digits.moveNext()) {
        std::string A = std::to_string(digits.peekNext());
        std::string B = "";
        while ((int)(B.length() + A.length()) &lt; POWER &amp;&amp; digits.position() != 0) {
</font>            B += '0';
        }
        out += (B + A);
    }
    return out;
}

<a name="7"></a><font color="#0000FF"><a href="http://moss.stanford.edu/results/7/7834820277962/match6-0.html#7" target="0"><img src="./tm_2_1.gif" alt="other" border="0" align="left"></a>

std::ostream&amp; operator&lt;&lt;(std::ostream&amp; stream, BigInteger N) {
    return stream &lt;&lt; N.BigInteger::to_string();
}

bool operator==(const BigInteger&amp; A, const BigInteger&amp; B) {
    int i = A.compare(B);
</font>    if (i == 0) {
        return true;
    } else {
        return false;
    }
}

bool operator&lt;(const BigInteger&amp; A, const BigInteger&amp; B) {
    int i = A.compare(B);
    if (i == -1) {
        return true;
    } else {
        return false;
    }
}

bool operator&lt;=(const BigInteger&amp; A, const BigInteger&amp; B) {
    int i = A.compare(B);
    if (i == 0 || i == -1) {
        return true;
    } else {
        return false;
    }
}

bool operator&gt;(const BigInteger&amp; A, const BigInteger&amp; B) {
    int i = A.compare(B);
    if (i == 1) {
        return true;
    } else {
        return false;
    }
}

bool operator&gt;=(const BigInteger&amp; A, const BigInteger&amp; B) {
    int i = A.compare(B);
    if (i == 0 || i == 1) {
        return true;
    } else {
        return false;
    }
}

BigInteger operator+(const BigInteger&amp; A, const BigInteger&amp; B) {
    return A.add(B);
}

BigInteger operator+=(BigInteger&amp; A, const BigInteger&amp; B) {
    BigInteger I = A.add(B);
    A.digits = I.digits;
    A.signum = I.signum;
    return A; 
}

BigInteger operator-(const BigInteger&amp; A, const BigInteger&amp; B) {
    return A.sub(B);
}

BigInteger operator-=(BigInteger&amp; A, const BigInteger&amp; B) {
    BigInteger I = A.sub(B);
    A.digits = I.digits;
    A.signum = I.signum;
    return A; 
}

BigInteger operator*(const BigInteger&amp; A, const BigInteger&amp; B) {
    return A.mult(B);
}

BigInteger operator*=(BigInteger&amp; A, const BigInteger&amp; B) {
    BigInteger I = A.mult(B);
    A.digits = I.digits;
    A.signum = I.signum;
    return A; 
}

</pre>



</body></html>